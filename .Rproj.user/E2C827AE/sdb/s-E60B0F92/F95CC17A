{
    "contents" : "require(XLConnect)\nlibrary(XLConnect)  \nlibrary(tidyr)\nlibrary(dplyr)\n\nGetLoansAppliedbyPurpose <-function() {\n  wk = loadWorkbook(\"1.10.xls\") \n  df = readWorksheet(wk, sheet=\"1.10\" )\n  \n  ##extract needed columns\n  df <- df[,c(\"X1.10\",\"Col2\",\"Sistem.Perbankan..Pinjaman.yang.Dipohon.Mengikut.Tujuan\",\"Col7\")] \n  \n  ##rename columns\n  names(df) <- c(\"Years\",\"Months\",\"DescriptionT\",\"AppliedPropertyLoan\") \n  \n  ##remove unused rows\n  df <-df[-c(1, 2, 3, 4, 5 , 6 ,7 ), ] \n  df <- subset(df,df$DescriptionT == \"Jumlah / Total \" )\n  df <-  subset(df,df$Years !=  2014 )\n  \n  ##fillin missing values\n  df[is.na(df)] <-0 \n  \n  ##convert data type\n  df <-  \n    df %>% \n    mutate_each(funs(as.character(.)), AppliedPropertyLoan) %>%\n    mutate_each(funs(gsub(\",\", \"\", .)), AppliedPropertyLoan) %>%\n    mutate_each(funs(as.numeric(.)), AppliedPropertyLoan)\n  df[,c(1)]<- sapply(df[, c(1)], as.integer)\n      \n  #Total Banking System: Loans Applied by Purpose\n  \n  df2 <- aggregate(x = list(Total = df$AppliedPropertyLoan), by=list(Years= df$Years), FUN=sum)\n  \n  return (df2)\n}\n\nGetLoansApprovedbyPurpose <-function() {\n  wk = loadWorkbook(\"1.12.xls\") \n  df = readWorksheet(wk, sheet=\"1.12\" )\n  \n  ##extract needed columns\n  df <- df[,c(\"X1.12\",\"Col2\",\"Sistem.Perbankan..Pinjaman.yang.Diluluskan.Mengikut.Tujuan\",\"Col7\")] \n  \n  ##rename columns\n  names(df) <- c(\"Years\",\"Months\",\"DescriptionT\",\"ApprovedPropertyLoan\") \n  \n  ##remove unused rows\n  df <-df[-c(1, 2, 3, 4, 5 , 6 ,7 ), ] \n  df <- subset(df,df$DescriptionT == \"Jumlah / Total \" )\n  df\n  \n  ##fillin missing values\n  df[is.na(df)] <-0 \n  \n  ##convert data type\n  df <-  \n    df %>% \n    mutate_each(funs(as.character(.)), ApprovedPropertyLoan) %>%\n    mutate_each(funs(gsub(\",\", \"\", .)), ApprovedPropertyLoan) %>%\n    mutate_each(funs(as.numeric(.)), ApprovedPropertyLoan)\n  df[,c(1)]<- sapply(df[, c(1)], as.integer)\n  \n  #Total Banking System: Loans Approved by Purpose\n  \n  df2 <- aggregate(x = list(Total = df$ApprovedPropertyLoan), by=list(Years= df$Years), FUN=sum)\n  \n  return (df2)\n}\n\n\nGetNPICData <-function() {\n  wk = loadWorkbook(\"BilangandanNilaiPindahMilikHartaTanahdanPerubahanTahunan1990-2014.xls\") \n  df = readWorksheet(wk, sheet=\"Sheet1\" , header = FALSE)\n  df\n  ##df <- transform(df, Col1 = colsplit(Col1, split = \" \", names = c('Years', 'VolumnOfTrans','ChangeInVol','Value','ChangeInVal')))\n  df <- strsplit(as.character(df$Col1),' ') \n  df<- do.call(rbind, df)\n  df <- data.frame(df, stringsAsFactors = FALSE)\n  names(df) <- c('Years', 'VolumnOfTrans','ChangeInVol','Value','ChangeInVal')\n  df\n  df[1,c(3)] <-0 \n  df[1,c(5)] <-0 \n  df[,c(1)]<- sapply(df[, c(1)], as.integer)\n  df[,c(2)]<- sapply(df[, c(2)], as.numeric)\n  df[,c(3)]<- sapply(df[, c(3)], as.numeric)\n  df[,c(4)]<- sapply(df[, c(4)], as.numeric)\n  df[,c(5)]<- sapply(df[, c(5)], as.numeric)  \n \n  #df[1:25,c(4)]  <- df[1:25,c(4)]*1000\n  return(df)\n}\n\n\n",
    "created" : 1453645955449.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3132793531",
    "id" : "F95CC17A",
    "lastKnownWriteTime" : 1453645947,
    "path" : "~/R/ShinyWebApp/general.R",
    "project_path" : "general.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}